
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>IC Advanced Basics - LOGIC Answer</title>

<style>
	body {margin:0px; padding:0px; background-color:#ccc; overflow:hidden;}
	#myCanvas {position:absolute; left:0px; top:0px; background-color:#2c3e50;}
</style>

<script src="https://code.createjs.com/easeljs-0.8.2.min.js"></script>


<script>

window.addEventListener("load", function() {

	var stageW;
	var stageH;
	var ready = false;
	var resize;
	var orientation;

	makeCanvas();

	var stage = new createjs.Stage("myCanvas");
	stage.enableMouseOver(10);  // leave out if mobile
	createjs.Touch.enable(stage, true);
	sizeStage();

	// end template header
	//------------------------------------------


	 var rows = 4;
	 var tileColor = "#e74c3c";
	 var spacingX = stageW*0.1;
	 var spacingY = stageH*0.1;
	 var sizeX = (stageW/rows - spacingX);
	 var sizeY = (stageH/rows - spacingY);
	 var posX = 0 + spacingX/2;
	 var posY = 0 + spacingY/2;
	 var numberArray = [];
	 var imgArray = ["img/monkey1.png", 
	 				 "img/monkey2.png",
	 				 "img/monkey3.png",
	 				 "img/monkey4.png",
	 				 "img/monkey5.png",
	 				 "img/monkey6.png",
	 				 "img/monkey7.png",
	 				 "img/monkey8.png"]

	// ORDER MATTERS
	createNumbers();

	var tiles = new createjs.Container();
	tiles.cursor = "pointer";
	stage.addChild(tiles);

	var idTag = 1;
	var tile, backing;
	function makeTiles() {
		for (var i=0; i<rows*rows; i++) {

			if (posX >= stageW) {
				posY += sizeY + spacingY;
				posX = 0 + spacingX/2;
			} 

			tile = new createjs.Container();
			tile.mouseChildren = false;

			backing = new createjs.Shape();
			backing.graphics.f(tileColor).drawRect(posX, posY, sizeX, sizeY);

			var rand = Math.floor(Math.random()*(numberArray.length));

			tile.number = numberArray.splice(rand, 1)[0];
			tile.id = idTag;
			idTag += 1;

			tile.addChild(backing);
			tiles.addChild(tile);

			img = new createjs.Bitmap(imgArray[tile.number]);
			img.setBounds(null, null, 40, 40);
			img.scaleX = img.scaleY = 0.2;
			var w = img.getBounds().width/2;
			var h = img.getBounds().height/2;
			img.x = posX + sizeX/2 - w;
			img.y = posY + sizeY/2 - h;
			img.alpha = 0;

			tile.addChild(img);

			tile.img = img;


			posX += sizeX + spacingX;
		}
	}
	makeTiles();

	function createNumbers() {
		var num = 0;
		
		for(i=0; i<(rows*rows)/2; i++) {
			numberArray.push(num);
			numberArray.push(num);
			num += 1;
		}
	}

	var checkArray = [];

	tiles.on("click", function(e) {
		
		if(checkArray.length == 0) {
			e.target.img.alpha = 1;
			checkArray.push(e.target);
			stage.update();
		} else if (checkArray[0].id == e.target.id){
			e.target.img.alpha = 0;
			checkArray = [];
			stage.update();
		} else if (checkArray[0].number == e.target.number) {
			e.target.img.alpha = 1;
			checkArray = [];
			gameCounter += 1;
			stage.update();
		} else if (checkArray[0].number != e.target.number) {
			e.target.img.alpha = 1;
			setTimeout(function(){
				checkArray[0].img.alpha = 0;
				e.target.img.alpha = 0;
				checkArray = [];
				stage.update();
			}, 500)
			stage.update();
		}

		stage.update();
		// var ticker = createjs.Ticker.on("tick", stage);
	});

	stage.on("tick", function(){
		if(gameCounter == ((rows*rows)/2)) {
			endGame();
		}
	})

	var gameCounter = 0;

	function endGame(){
		alert("You Win! Play Again?");
		location.reload();
	}

	/////////////////////////////////////////////////////////

	// resize = function() {
	// 	// here is where we put code to resize

	// 	makeTiles();
	// 	// would want to scale ending too but not going to bother
	// 	stage.update();
	// }

	stage.update();
	ready = true;

	// ----------------------------------------------
	// start template footer
	function makeCanvas() {
		// make a canvas tag and apply attributes for id, width and height
		var canvas = document.createElement("canvas");
		canvas.setAttribute("id", "myCanvas");

		// get maximum size for canvas
		// note: iOS6 does not work from loading icon unless keep canvas within device size
		// thank you apple for this and many other days of hell
		largest = Math.max(window.innerWidth, screen.width, window.innerHeight, screen.height);
		if (!/ip(hone|od|ad)/i.test(navigator.userAgent)) largest *= 3; // handle up to three monitors
		canvas.setAttribute("width", largest);
		canvas.setAttribute("height", largest);

		// add our canvas tag
		document.body.appendChild(canvas);

		// stop the canvas from moving when certain keys are pressed (pgdwn, pgup, arrows, home, end)
		// and stop scrollwheel from moving page
		var a = function(e) {
			if (!e) e = event;
			if (e.keyCode && (e.keyCode >= 32 && e.keyCode <= 40)) e.preventDefault();
		}
		var b = function(e) {
			if (!e) e = event;
			e.preventDefault();
		}
		var c = b;
		window.addEventListener("keydown", a);
		window.addEventListener("mousewheel", b);
		window.addEventListener("DOMMouseScroll", c);
		window.addEventListener('resize', function() {
			sizeStage();
			if (/ios|android|nexus/i.test(navigator.userAgent)) {
				setTimeout(function() {
					sizeStage();
				}, 500); // to catch delayed screen sizes
			}
		});
	}

	function sizeStage() {
		// earlier than IE9 does not have innerWidth
		// inner is better on mobile when zoomed so can't always use client
		// ternary operator
		stageW = isNaN(window.innerWidth) ? window.clientWidth : window.innerWidth;
		stageH = isNaN(window.innerHeight) ? window.clientHeight : window.innerHeight;

		// if wider than high then we have horizontal (or landscape)
		orientation = (stageW>stageH) ? "horizontal" : "vertical";

		if (stage) stage.setBounds(0,0,stageW,stageH);
		// if (ready) resize();
	}
});

</script>
</head>
<body>
</body>
</html>